- name: Update OS and software (AlmaLinux)
  tags: always
  dnf: 
    name: "*"
    state: latest
    update_cache: yes
  when: ansible_distribution == "AlmaLinux"
  register: system_updated

- name: update repo index (CentOS)
  tags: always
  yum: 
    name: "*"
    state: latest
    update_cache: yes
  when: ansible_distribution == "CentOS"
  register: system_updated

- name: Reboot servers
  become: true
  when: system_updated.changed
  reboot:
